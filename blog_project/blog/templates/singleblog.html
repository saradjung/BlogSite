{% extends 'base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow-md mt-20">
      <!-- Back to Home Link -->
      <a href="{% url 'home' %}" class="text-sm text-blue-500 hover:underline">&larr; Back to Home</a>
    <h1 class="text-3xl font-bold text-gray-800">{{ post.title }}</h1>

    <p class="text-gray-600 text-sm mt-2">
        By <span class="font-semibold">{{ post.author }}</span> ‚Ä¢ 
        Published on <span class="text-blue-500">{{ post.created_at|date:"F d, Y" }}</span>
    </p>

    <hr class="my-4">
    {% if post.image %}
        <img src="{{ post.image.url }}" alt="Blog Image" class="w-full h-auto rounded-lg shadow-md mt-4">
    {% endif %}

    <p class="text-lg text-gray-700 mt-4">
        {{ post.content }}
    </p>

    <!-- Like and Comment Section -->
    <div class="mt-6 flex items-center space-x-4">
        <!-- Like Button -->
        <form action="{% url 'like_post' post.id%}" method="POST">
            {% csrf_token %}
            <button type="submit" class="px-4 py-2 bg-blue-500 text-white rounded-lg shadow-md">
                
                    ‚ù§Ô∏è Like ({{ post.total_likes }})
                
            </button>
        </form>

        <!-- Comment Button -->
        <a href="#comment-section" class="px-4 py-2 bg-green-500 text-white rounded-lg shadow-md">üí¨ Comment</a>
    </div>

    <hr class="my-6">

    <!-- Comment Section -->
    <div id="comment-section" class="mt-6">
        <h2 class="text-xl font-semibold">Discussion about this post</h2>
        
        {% if user.is_authenticated %}
        <form action="{% url 'add_comment' post.id%}" method="POST" class="mt-4">
            {% csrf_token %}
            <textarea name="content" class="w-full p-2 border rounded" placeholder="Write a comment..." required></textarea>
            <button type="submit" class="mt-2 px-4 py-2 bg-green-500 text-white rounded">Post Comment</button>
        </form>
        {% else %}
        <p><a href="{% url 'login' %}" class="text-blue-500">Log in</a> to comment.</p>
        {% endif %}

        <!-- Display Comments -->
        <div class="mt-4">
            {% for comment in post.comments.all %}
                <div class="border-b pb-2 mb-2">
                    <p class="text-sm text-gray-600"><strong>{{ comment.user.username }}</strong> ‚Ä¢ {{ comment.created_at|date:"F d, Y" }}</p>
                    <p class="text-gray-800">{{ comment.content }}</p>
                </div>
            {% empty %}
                <p class="text-gray-500">No comments yet.</p>
            {% endfor %}
        </div>
    </div>

    
</div>
{% endblock %}